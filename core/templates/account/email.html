{% extends "base.html" %}
{% load static allauth i18n %}
{% block head_title %}
    {% trans "Email Addresses" %}
{% endblock head_title %}
{% block content %}
    <style>
      body {
        background: linear-gradient(135deg, #fffbe6 0%, #ffffff 100%);
        min-height: 100vh;
      }
      .email-card {
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        border-radius: 20px;
        background: #fff;
        border: none;
        animation: fadeInUp 1s cubic-bezier(.39,.575,.565,1.000);
        transition: box-shadow 0.3s;
      }
      .email-card:hover {
        box-shadow: 0 16px 48px 0 rgba(255, 193, 7, 0.25);
      }
      @keyframes fadeInUp {
        0% { opacity: 0; transform: translateY(40px); }
        100% { opacity: 1; transform: translateY(0); }
      }
      .email-title {
        color: #ffc107;
        font-weight: 700;
        letter-spacing: 1px;
      }
      .btn-primary {
        background-color: #ffc107;
        border-color: #ffc107;
        color: #fff;
        font-weight: 600;
        transition: background 0.2s;
      }
      .btn-primary:hover {
        background-color: #ffda44;
        border-color: #ffda44;
        color: #212529;
      }
      .btn-secondary {
        background-color: #6c757d;
        border-color: #6c757d;
        color: #fff;
        font-weight: 600;
      }
      .btn-danger {
        background-color: #dc3545;
        border-color: #dc3545;
        color: #fff;
        font-weight: 600;
      }
      .btn-outline-warning {
        border-color: #ffc107;
        color: #ffc107;
        background: #fff;
        font-weight: 600;
        transition: background 0.2s, color 0.2s;
      }
      .btn-outline-warning:hover {
        background: #ffc107;
        color: #fff;
      }
      .form-control:focus {
        border-color: #ffc107;
        box-shadow: 0 0 0 0.2rem rgba(255,193,7,.25);
      }
      .email-card hr {
        border-top: 1px solid #ffe082;
      }
      .badge-success {
        background-color: #28a745;
      }
      .badge-warning {
        background-color: #ffc107;
        color: #212529;
      }
      .badge-primary {
        background-color: #007bff;
      }
      .email-item {
        padding: 0.75rem;
        margin-bottom: 0.5rem;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        background: #f8f9fa;
      }
    </style>
    <div class="container d-flex align-items-center justify-content-center" style="min-height: 100vh;">
      <div class="card email-card p-4 col-md-8 col-lg-6">
        <h2 class="email-title mb-4 text-center">Email Addresses</h2>
        
        {% if emailaddresses %}
          <p class="mb-3">The following email addresses are associated with your account:</p>
          {% url 'account_email' as email_url %}
          <form action="{{ email_url }}" method="post">
            {% csrf_token %}
            {% for radio in emailaddress_radios %}
              {% with emailaddress=radio.emailaddress %}
                <div class="email-item">
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="email" value="{{ emailaddress.email }}" id="{{ radio.id }}" {% if radio.checked %}checked{% endif %}>
                    <label class="form-check-label" for="{{ radio.id }}">
                      {{ emailaddress.email }}
                      {% if emailaddress.verified %}
                        <span class="badge badge-success ms-2">Verified</span>
                      {% else %}
                        <span class="badge badge-warning ms-2">Unverified</span>
                      {% endif %}
                      {% if emailaddress.primary %}
                        <span class="badge badge-primary ms-2">Primary</span>
                      {% endif %}
                    </label>
                  </div>
                </div>
              {% endwith %}
            {% endfor %}
            <div class="mt-3">
              <button type="submit" name="action_primary" class="btn btn-primary me-2">Make Primary</button>
              <button type="submit" name="action_send" class="btn btn-secondary me-2">Re-send Verification</button>
              <button type="submit" name="action_remove" class="btn btn-danger">Remove</button>
            </div>
          </form>
        {% else %}
          {% include "account/snippets/warn_no_email.html" %}
        {% endif %}
        
        {% if can_add_email %}
          <hr>
          <h4 class="email-title mb-3">Add Email Address</h4>
          {% url 'account_email' as action_url %}
          <form method="post" action="{{ action_url }}">
            {% csrf_token %}
            {{ form.as_p }}
            <button name="action_add" type="submit" class="btn btn-primary w-100">Add Email</button>
          </form>
        {% endif %}
        
        <hr>
        <div class="text-center">
          <a href="{% url 'home' %}" class="btn btn-outline-warning">Back to Home page</a>
        </div>
      </div>
    </div>
{% endblock content %}
{% block extra_body %}
    <script>
        // Confirmation for email removal
        document.addEventListener('DOMContentLoaded', function() {
            const removeBtn = document.querySelector('button[name="action_remove"]');
            if (removeBtn) {
                removeBtn.addEventListener('click', function(e) {
                    if (!confirm('Do you really want to remove the selected email address?')) {
                        e.preventDefault();
                    }
                });
            }
        });
    </script>
{% endblock extra_body %}
